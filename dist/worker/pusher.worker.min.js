/*!
 * Pusher JavaScript Library v5.0.2
 * https://pusher.com/
 *
 * Copyright 2017, Pusher
 * Released under the MIT licence.
 */
var Pusher=function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){t.exports=e(1).default},function(t,n,e){"use strict";e.r(n);for(var o=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={},s=0,c=i.length;s<c;s++)r[i.charAt(s)]=s;var a,u=function(t){var n=t.charCodeAt(0);return n<128?t:n<2048?o(192|n>>>6)+o(128|63&n):o(224|n>>>12&15)+o(128|n>>>6&63)+o(128|63&n)},h=function(t){return t.replace(/[^\x00-\x7F]/g,u)},p=function(t){var n=[0,2,1][t.length%3],e=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[i.charAt(e>>>18),i.charAt(e>>>12&63),n>=2?"=":i.charAt(e>>>6&63),n>=1?"=":i.charAt(63&e)].join("")},l=self.btoa||function(t){return t.replace(/[\s\S]{1,3}/g,p)},f=function(){function t(t,n,e,o){var i=this;this.clear=n,this.timer=t((function(){i.timer&&(i.timer=o(i.timer))}),e)}return t.prototype.isRunning=function(){return null!==this.timer},t.prototype.ensureAborted=function(){this.timer&&(this.clear(this.timer),this.timer=null)},t}(),d=(a=function(t,n){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});function y(t){self.clearTimeout(t)}function b(t){self.clearInterval(t)}var g=function(t){function n(n,e){return t.call(this,setTimeout,y,n,(function(t){return e(),null}))||this}return d(n,t),n}(f),v=function(t){function n(n,e){return t.call(this,setInterval,b,n,(function(t){return e(),t}))||this}return d(n,t),n}(f),m={now:function(){return Date.now?Date.now():(new Date).valueOf()},defer:function(t){return new g(0,t)},method:function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var o=Array.prototype.slice.call(arguments,1);return function(n){return n[t].apply(n,o.concat(arguments))}}};function _(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(var o=0;o<n.length;o++){var i=n[o];for(var r in i)i[r]&&i[r].constructor&&i[r].constructor===Object?t[r]=_(t[r]||{},i[r]):t[r]=i[r]}return t}function S(){for(var t=["Pusher"],n=0;n<arguments.length;n++)"string"==typeof arguments[n]?t.push(arguments[n]):t.push(j(arguments[n]));return t.join(" : ")}function k(t,n){var e=Array.prototype.indexOf;if(null===t)return-1;if(e&&t.indexOf===e)return t.indexOf(n);for(var o=0,i=t.length;o<i;o++)if(t[o]===n)return o;return-1}function w(t,n){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&n(t[e],e,t)}function T(t){var n=[];return w(t,(function(t,e){n.push(e)})),n}function C(t,n,e){for(var o=0;o<t.length;o++)n.call(e||self,t[o],o,t)}function O(t,n){for(var e=[],o=0;o<t.length;o++)e.push(n(t[o],o,t,e));return e}function P(t,n){n=n||function(t){return!!t};for(var e=[],o=0;o<t.length;o++)n(t[o],o,t,e)&&e.push(t[o]);return e}function L(t,n){var e={};return w(t,(function(o,i){(n&&n(o,i,t,e)||Boolean(o))&&(e[i]=o)})),e}function A(t,n){for(var e=0;e<t.length;e++)if(n(t[e],e,t))return!0;return!1}function E(t){return n=function(t){return"object"==typeof t&&(t=j(t)),encodeURIComponent((n=t.toString(),l(h(n))));var n},e={},w(t,(function(t,o){e[o]=n(t)})),e;var n,e}function R(t){var n,e,o=L(t,(function(t){return void 0!==t}));return O((n=E(o),e=[],w(n,(function(t,n){e.push([n,t])})),e),m.method("join","=")).join("&")}function j(t){try{return JSON.stringify(t)}catch(o){return JSON.stringify((n=[],e=[],function t(o,i){var r,s,c;switch(typeof o){case"object":if(!o)return null;for(r=0;r<n.length;r+=1)if(n[r]===o)return{$ref:e[r]};if(n.push(o),e.push(i),"[object Array]"===Object.prototype.toString.apply(o))for(c=[],r=0;r<o.length;r+=1)c[r]=t(o[r],i+"["+r+"]");else for(s in c={},o)Object.prototype.hasOwnProperty.call(o,s)&&(c[s]=t(o[s],i+"["+JSON.stringify(s)+"]"));return c;case"number":case"string":case"boolean":return o}}(t,"$")))}var n,e}var x={VERSION:"5.0.2",PROTOCOL:7,host:"ws.pusherapp.com",ws_port:80,wss_port:443,ws_path:"",sockjs_host:"sockjs.pusher.com",sockjs_http_port:80,sockjs_https_port:443,sockjs_path:"/pusher",stats_host:"stats.pusher.com",channel_auth_endpoint:"/pusher/auth",channel_auth_transport:"ajax",activity_timeout:12e4,pong_timeout:3e4,unavailable_timeout:1e4,cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""};function I(t,n,e){return t+(n.useTLS?"s":"")+"://"+(n.useTLS?n.hostTLS:n.hostNonTLS)+e}function M(t,n){return"/app/"+t+("?protocol="+x.PROTOCOL+"&client=js&version="+x.VERSION+(n?"&"+n:""))}var D={getInitial:function(t,n){return I("ws",n,(n.httpPath||"")+M(t,"flash=false"))}},N={getInitial:function(t,n){return I("http",n,(n.httpPath||"/pusher")+M(t))}},H=function(){function t(){this._callbacks={}}return t.prototype.get=function(t){return this._callbacks[U(t)]},t.prototype.add=function(t,n,e){var o=U(t);this._callbacks[o]=this._callbacks[o]||[],this._callbacks[o].push({fn:n,context:e})},t.prototype.remove=function(t,n,e){if(t||n||e){var o=t?[U(t)]:T(this._callbacks);n||e?this.removeCallback(o,n,e):this.removeAllCallbacks(o)}else this._callbacks={}},t.prototype.removeCallback=function(t,n,e){C(t,(function(t){this._callbacks[t]=P(this._callbacks[t]||[],(function(t){return n&&n!==t.fn||e&&e!==t.context})),0===this._callbacks[t].length&&delete this._callbacks[t]}),this)},t.prototype.removeAllCallbacks=function(t){C(t,(function(t){delete this._callbacks[t]}),this)},t}();function U(t){return"_"+t}var z=function(){function t(t){this.callbacks=new H,this.global_callbacks=[],this.failThrough=t}return t.prototype.bind=function(t,n,e){return this.callbacks.add(t,n,e),this},t.prototype.bind_global=function(t){return this.global_callbacks.push(t),this},t.prototype.unbind=function(t,n,e){return this.callbacks.remove(t,n,e),this},t.prototype.unbind_global=function(t){return t?(this.global_callbacks=P(this.global_callbacks||[],(function(n){return n!==t})),this):(this.global_callbacks=[],this)},t.prototype.unbind_all=function(){return this.unbind(),this.unbind_global(),this},t.prototype.emit=function(t,n,e){for(var o=0;o<this.global_callbacks.length;o++)this.global_callbacks[o](t,n);var i=this.callbacks.get(t),r=[];if(e?r.push(n,e):n&&r.push(n),i&&i.length>0)for(o=0;o<i.length;o++)i[o].fn.apply(i[o].context||self,r);else this.failThrough&&this.failThrough(t,n);return this},t}(),q={debug:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];hn.log&&hn.log(S.apply(this,arguments))},warn:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=S.apply(this,arguments);hn.log?hn.log(e):self.console&&(self.console.warn?self.console.warn(e):self.console.log&&self.console.log(e))}},F=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),B=function(t){function n(n,e,o,i,r){var s=t.call(this)||this;return s.initialize=Kt.transportConnectionInitializer,s.hooks=n,s.name=e,s.priority=o,s.key=i,s.options=r,s.state="new",s.timeline=r.timeline,s.activityTimeout=r.activityTimeout,s.id=s.timeline.generateUniqueID(),s}return F(n,t),n.prototype.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)},n.prototype.supportsPing=function(){return Boolean(this.hooks.supportsPing)},n.prototype.connect=function(){var t=this;if(this.socket||"initialized"!==this.state)return!1;var n=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(n,this.options)}catch(n){return m.defer((function(){t.onError(n),t.changeState("closed")})),!1}return this.bindListeners(),q.debug("Connecting",{transport:this.name,url:n}),this.changeState("connecting"),!0},n.prototype.close=function(){return!!this.socket&&(this.socket.close(),!0)},n.prototype.send=function(t){var n=this;return"open"===this.state&&(m.defer((function(){n.socket&&n.socket.send(t)})),!0)},n.prototype.ping=function(){"open"===this.state&&this.supportsPing()&&this.socket.ping()},n.prototype.onOpen=function(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0},n.prototype.onError=function(t){this.emit("error",{type:"WebSocketError",error:t}),this.timeline.error(this.buildTimelineMessage({error:t.toString()}))},n.prototype.onClose=function(t){t?this.changeState("closed",{code:t.code,reason:t.reason,wasClean:t.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0},n.prototype.onMessage=function(t){this.emit("message",t)},n.prototype.onActivity=function(){this.emit("activity")},n.prototype.bindListeners=function(){var t=this;this.socket.onopen=function(){t.onOpen()},this.socket.onerror=function(n){t.onError(n)},this.socket.onclose=function(n){t.onClose(n)},this.socket.onmessage=function(n){t.onMessage(n)},this.supportsPing()&&(this.socket.onactivity=function(){t.onActivity()})},n.prototype.unbindListeners=function(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))},n.prototype.changeState=function(t,n){this.state=t,this.timeline.info(this.buildTimelineMessage({state:t,params:n})),this.emit(t,n)},n.prototype.buildTimelineMessage=function(t){return _({cid:this.id},t)},n}(z),J=function(){function t(t){this.hooks=t}return t.prototype.isSupported=function(t){return this.hooks.isSupported(t)},t.prototype.createConnection=function(t,n,e,o){return new B(this.hooks,t,n,e,o)},t}(),X=new J({urls:D,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(Kt.getWebSocketAPI())},isSupported:function(){return Boolean(Kt.getWebSocketAPI())},getSocket:function(t){return Kt.createWebSocket(t)}}),W={urls:N,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},G=_({getSocket:function(t){return Kt.HTTPFactory.createStreamingSocket(t)}},W),Q=_({getSocket:function(t){return Kt.HTTPFactory.createPollingSocket(t)}},W),V={isSupported:function(){return Kt.isXHRSupported()}},Y={ws:X,xhr_streaming:new J(_({},G,V)),xhr_polling:new J(_({},Q,V))},$=function(){function t(t,n,e){this.manager=t,this.transport=n,this.minPingDelay=e.minPingDelay,this.maxPingDelay=e.maxPingDelay,this.pingDelay=void 0}return t.prototype.createConnection=function(t,n,e,o){var i=this;o=_({},o,{activityTimeout:this.pingDelay});var r=this.transport.createConnection(t,n,e,o),s=null,c=function(){r.unbind("open",c),r.bind("closed",a),s=m.now()},a=function(t){if(r.unbind("closed",a),1002===t.code||1003===t.code)i.manager.reportDeath();else if(!t.wasClean&&s){var n=m.now()-s;n<2*i.maxPingDelay&&(i.manager.reportDeath(),i.pingDelay=Math.max(n/2,i.minPingDelay))}};return r.bind("open",c),r},t.prototype.isSupported=function(t){return this.manager.isAlive()&&this.transport.isSupported(t)},t}(),K={decodeMessage:function(t){try{var n=JSON.parse(t.data),e=n.data;if("string"==typeof e)try{e=JSON.parse(n.data)}catch(t){}var o={event:n.event,channel:n.channel,data:e};return n.user_id&&(o.user_id=n.user_id),o}catch(n){throw{type:"MessageParseError",error:n,data:t.data}}},encodeMessage:function(t){return JSON.stringify(t)},processHandshake:function(t){var n=K.decodeMessage(t);if("pusher:connection_established"===n.event){if(!n.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:n.data.socket_id,activityTimeout:1e3*n.data.activity_timeout}}if("pusher:error"===n.event)return{action:this.getCloseAction(n.data),error:this.getCloseError(n.data)};throw"Invalid handshake"},getCloseAction:function(t){return t.code<4e3?t.code>=1002&&t.code<=1004?"backoff":null:4e3===t.code?"tls_only":t.code<4100?"refused":t.code<4200?"backoff":t.code<4300?"retry":"refused"},getCloseError:function(t){return 1e3!==t.code&&1001!==t.code?{type:"PusherError",data:{code:t.code,message:t.reason||t.message}}:null}},Z=K,tt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),nt=function(t){function n(n,e){var o=t.call(this)||this;return o.id=n,o.transport=e,o.activityTimeout=e.activityTimeout,o.bindListeners(),o}return tt(n,t),n.prototype.handlesActivityChecks=function(){return this.transport.handlesActivityChecks()},n.prototype.send=function(t){return this.transport.send(t)},n.prototype.send_event=function(t,n,e){var o={event:t,data:n};return e&&(o.channel=e),q.debug("Event sent",o),this.send(Z.encodeMessage(o))},n.prototype.ping=function(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})},n.prototype.close=function(){this.transport.close()},n.prototype.bindListeners=function(){var t=this,n={message:function(n){var e;try{e=Z.decodeMessage(n)}catch(e){t.emit("error",{type:"MessageParseError",error:e,data:n.data})}if(void 0!==e){switch(q.debug("Event recd",e),e.event){case"pusher:error":t.emit("error",{type:"PusherError",data:e.data});break;case"pusher:ping":t.emit("ping");break;case"pusher:pong":t.emit("pong")}t.emit("message",e)}},activity:function(){t.emit("activity")},error:function(n){t.emit("error",{type:"WebSocketError",error:n})},closed:function(n){e(),n&&n.code&&t.handleCloseEvent(n),t.transport=null,t.emit("closed")}},e=function(){w(n,(function(n,e){t.transport.unbind(e,n)}))};w(n,(function(n,e){t.transport.bind(e,n)}))},n.prototype.handleCloseEvent=function(t){var n=Z.getCloseAction(t),e=Z.getCloseError(t);e&&this.emit("error",e),n&&this.emit(n,{action:n,error:e})},n}(z),et=function(){function t(t,n){this.transport=t,this.callback=n,this.bindListeners()}return t.prototype.close=function(){this.unbindListeners(),this.transport.close()},t.prototype.bindListeners=function(){var t=this;this.onMessage=function(n){var e;t.unbindListeners();try{e=Z.processHandshake(n)}catch(n){return t.finish("error",{error:n}),void t.transport.close()}"connected"===e.action?t.finish("connected",{connection:new nt(e.id,t.transport),activityTimeout:e.activityTimeout}):(t.finish(e.action,{error:e.error}),t.transport.close())},this.onClosed=function(n){t.unbindListeners();var e=Z.getCloseAction(n)||"backoff",o=Z.getCloseError(n);t.finish(e,{error:o})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)},t.prototype.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},t.prototype.finish=function(t,n){this.callback(_({transport:this.transport,action:t},n))},t}(),ot=function(){function t(t,n){this.channel=t;var e=n.authTransport;if(void 0===Kt.getAuthorizers()[e])throw"'"+e+"' is not a recognized auth transport";this.type=e,this.options=n,this.authOptions=(n||{}).auth||{}}return t.prototype.composeQuery=function(t){var n="socket_id="+encodeURIComponent(t)+"&channel_name="+encodeURIComponent(this.channel.name);for(var e in this.authOptions.params)n+="&"+encodeURIComponent(e)+"="+encodeURIComponent(this.authOptions.params[e]);return n},t.prototype.authorize=function(n,e){return t.authorizers=t.authorizers||Kt.getAuthorizers(),t.authorizers[this.type].call(this,Kt,n,e)},t}(),it=function(){function t(t,n){this.timeline=t,this.options=n||{}}return t.prototype.send=function(t,n){this.timeline.isEmpty()||this.timeline.send(Kt.TimelineTransport.getAgent(this,t),n)},t}(),rt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),st=function(t){function n(n){var e=this.constructor,o=t.call(this,n)||this;return Object.setPrototypeOf(o,e.prototype),o}return rt(n,t),n}(Error),ct=(function(t){function n(n){var e=this.constructor,o=t.call(this,n)||this;return Object.setPrototypeOf(o,e.prototype),o}rt(n,t)}(Error),function(t){function n(n){var e=this.constructor,o=t.call(this,n)||this;return Object.setPrototypeOf(o,e.prototype),o}return rt(n,t),n}(Error)),at=function(t){function n(n){var e=this.constructor,o=t.call(this,n)||this;return Object.setPrototypeOf(o,e.prototype),o}return rt(n,t),n}(Error),ut=(function(t){function n(n){var e=this.constructor,o=t.call(this,n)||this;return Object.setPrototypeOf(o,e.prototype),o}rt(n,t)}(Error),function(t){function n(n){var e=this.constructor,o=t.call(this,n)||this;return Object.setPrototypeOf(o,e.prototype),o}return rt(n,t),n}(Error)),ht=function(t){function n(n){var e=this.constructor,o=t.call(this,n)||this;return Object.setPrototypeOf(o,e.prototype),o}return rt(n,t),n}(Error),pt={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/authenticating_users"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"}}},lt={buildLogSuffix:function(t){var n,e=pt.urls[t];return e?(e.fullUrl?n=e.fullUrl:e.path&&(n=pt.baseUrl+e.path),n?"See: "+n:""):""}},ft=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),dt=function(t){function n(n,e){var o=t.call(this,(function(t,e){q.debug("No callbacks on "+n+" for "+t)}))||this;return o.name=n,o.pusher=e,o.subscribed=!1,o.subscriptionPending=!1,o.subscriptionCancelled=!1,o}return ft(n,t),n.prototype.authorize=function(t,n){return n(!1,{})},n.prototype.trigger=function(t,n){if(0!==t.indexOf("client-"))throw new st("Event '"+t+"' does not start with 'client-'");if(!this.subscribed){var e=lt.buildLogSuffix("triggeringClientEvents");q.warn("Client event triggered before channel 'subscription_succeeded' event . "+e)}return this.pusher.send_event(t,n,this.name)},n.prototype.disconnect=function(){this.subscribed=!1,this.subscriptionPending=!1},n.prototype.handleEvent=function(t){var n=t.event,e=t.data;if("pusher_internal:subscription_succeeded"===n)this.handleSubscriptionSucceededEvent(t);else if(0!==n.indexOf("pusher_internal:")){this.emit(n,e,{})}},n.prototype.handleSubscriptionSucceededEvent=function(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",t.data)},n.prototype.subscribe=function(){var t=this;this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(function(n,e){n?t.emit("pusher:subscription_error",e):t.pusher.send_event("pusher:subscribe",{auth:e.auth,channel_data:e.channel_data,channel:t.name})})))},n.prototype.unsubscribe=function(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},n.prototype.cancelSubscription=function(){this.subscriptionCancelled=!0},n.prototype.reinstateSubscription=function(){this.subscriptionCancelled=!1},n}(z),yt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),bt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return yt(n,t),n.prototype.authorize=function(t,n){return wt.createAuthorizer(this,this.pusher.config).authorize(t,n)},n}(dt),gt=function(){function t(){this.reset()}return t.prototype.get=function(t){return Object.prototype.hasOwnProperty.call(this.members,t)?{id:t,info:this.members[t]}:null},t.prototype.each=function(t){var n=this;w(this.members,(function(e,o){t(n.get(o))}))},t.prototype.setMyID=function(t){this.myID=t},t.prototype.onSubscription=function(t){this.members=t.presence.hash,this.count=t.presence.count,this.me=this.get(this.myID)},t.prototype.addMember=function(t){return null===this.get(t.user_id)&&this.count++,this.members[t.user_id]=t.user_info,this.get(t.user_id)},t.prototype.removeMember=function(t){var n=this.get(t.user_id);return n&&(delete this.members[t.user_id],this.count--),n},t.prototype.reset=function(){this.members={},this.count=0,this.myID=null,this.me=null},t}(),vt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),mt=function(t){function n(n,e){var o=t.call(this,n,e)||this;return o.members=new gt,o}return vt(n,t),n.prototype.authorize=function(n,e){var o=this;t.prototype.authorize.call(this,n,(function(t,n){if(!t){if(void 0===n.channel_data){var i=lt.buildLogSuffix("authenticationEndpoint");return q.warn("Invalid auth response for channel '"+o.name+"',expected 'channel_data' field. "+i),void e("Invalid auth response")}var r=JSON.parse(n.channel_data);o.members.setMyID(r.user_id)}e(t,n)}))},n.prototype.handleEvent=function(t){var n=t.event;if(0===n.indexOf("pusher_internal:"))this.handleInternalEvent(t);else{var e=t.data,o={};t.user_id&&(o.user_id=t.user_id),this.emit(n,e,o)}},n.prototype.handleInternalEvent=function(t){var n=t.event,e=t.data;switch(n){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(t);break;case"pusher_internal:member_added":var o=this.members.addMember(e);this.emit("pusher:member_added",o);break;case"pusher_internal:member_removed":var i=this.members.removeMember(e);i&&this.emit("pusher:member_removed",i)}},n.prototype.handleSubscriptionSucceededEvent=function(t){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(t.data),this.emit("pusher:subscription_succeeded",this.members))},n.prototype.disconnect=function(){this.members.reset(),t.prototype.disconnect.call(this)},n}(bt),_t=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),St=function(t){function n(n,e){var o=t.call(this)||this;o.key=n,o.options=e||{},o.state="initialized",o.connection=null,o.usingTLS=!!e.useTLS,o.timeline=o.options.timeline,o.errorCallbacks=o.buildErrorCallbacks(),o.connectionCallbacks=o.buildConnectionCallbacks(o.errorCallbacks),o.handshakeCallbacks=o.buildHandshakeCallbacks(o.errorCallbacks);var i=Kt.getNetwork();return i.bind("online",(function(){o.timeline.info({netinfo:"online"}),"connecting"!==o.state&&"unavailable"!==o.state||o.retryIn(0)})),i.bind("offline",(function(){o.timeline.info({netinfo:"offline"}),o.connection&&o.sendActivityCheck()})),o.updateStrategy(),o}return _t(n,t),n.prototype.connect=function(){this.connection||this.runner||(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))},n.prototype.send=function(t){return!!this.connection&&this.connection.send(t)},n.prototype.send_event=function(t,n,e){return!!this.connection&&this.connection.send_event(t,n,e)},n.prototype.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},n.prototype.isUsingTLS=function(){return this.usingTLS},n.prototype.startConnecting=function(){var t=this,n=function(e,o){e?t.runner=t.strategy.connect(0,n):"error"===o.action?(t.emit("error",{type:"HandshakeError",error:o.error}),t.timeline.error({handshakeError:o.error})):(t.abortConnecting(),t.handshakeCallbacks[o.action](o))};this.runner=this.strategy.connect(0,n)},n.prototype.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},n.prototype.disconnectInternally=function(){(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection)&&this.abandonConnection().close()},n.prototype.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})},n.prototype.retryIn=function(t){var n=this;this.timeline.info({action:"retry",delay:t}),t>0&&this.emit("connecting_in",Math.round(t/1e3)),this.retryTimer=new g(t||0,(function(){n.disconnectInternally(),n.connect()}))},n.prototype.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},n.prototype.setUnavailableTimer=function(){var t=this;this.unavailableTimer=new g(this.options.unavailableTimeout,(function(){t.updateState("unavailable")}))},n.prototype.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},n.prototype.sendActivityCheck=function(){var t=this;this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new g(this.options.pongTimeout,(function(){t.timeline.error({pong_timed_out:t.options.pongTimeout}),t.retryIn(0)}))},n.prototype.resetActivityCheck=function(){var t=this;this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new g(this.activityTimeout,(function(){t.sendActivityCheck()})))},n.prototype.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},n.prototype.buildConnectionCallbacks=function(t){var n=this;return _({},t,{message:function(t){n.resetActivityCheck(),n.emit("message",t)},ping:function(){n.send_event("pusher:pong",{})},activity:function(){n.resetActivityCheck()},error:function(t){n.emit("error",{type:"WebSocketError",error:t})},closed:function(){n.abandonConnection(),n.shouldRetry()&&n.retryIn(1e3)}})},n.prototype.buildHandshakeCallbacks=function(t){var n=this;return _({},t,{connected:function(t){n.activityTimeout=Math.min(n.options.activityTimeout,t.activityTimeout,t.connection.activityTimeout||1/0),n.clearUnavailableTimer(),n.setConnection(t.connection),n.socket_id=n.connection.id,n.updateState("connected",{socket_id:n.socket_id})}})},n.prototype.buildErrorCallbacks=function(){var t=this,n=function(n){return function(e){e.error&&t.emit("error",{type:"WebSocketError",error:e.error}),n(e)}};return{tls_only:n((function(){t.usingTLS=!0,t.updateStrategy(),t.retryIn(0)})),refused:n((function(){t.disconnect()})),backoff:n((function(){t.retryIn(1e3)})),retry:n((function(){t.retryIn(0)}))}},n.prototype.setConnection=function(t){for(var n in this.connection=t,this.connectionCallbacks)this.connection.bind(n,this.connectionCallbacks[n]);this.resetActivityCheck()},n.prototype.abandonConnection=function(){if(this.connection){for(var t in this.stopActivityCheck(),this.connectionCallbacks)this.connection.unbind(t,this.connectionCallbacks[t]);var n=this.connection;return this.connection=null,n}},n.prototype.updateState=function(t,n){var e=this.state;if(this.state=t,e!==t){var o=t;"connected"===o&&(o+=" with new socket ID "+n.socket_id),q.debug("State changed",e+" -> "+o),this.timeline.info({state:t,params:n}),this.emit("state_change",{previous:e,current:t}),this.emit(t,n)}},n.prototype.shouldRetry=function(){return"connecting"===this.state||"connected"===this.state},n}(z),kt=function(){function t(){this.channels={}}return t.prototype.add=function(t,n){return this.channels[t]||(this.channels[t]=function(t,n){return 0===t.indexOf("private-")?wt.createPrivateChannel(t,n):0===t.indexOf("presence-")?wt.createPresenceChannel(t,n):wt.createChannel(t,n)}(t,n)),this.channels[t]},t.prototype.all=function(){return function(t){var n=[];return w(t,(function(t){n.push(t)})),n}(this.channels)},t.prototype.find=function(t){return this.channels[t]},t.prototype.remove=function(t){var n=this.channels[t];return delete this.channels[t],n},t.prototype.disconnect=function(){w(this.channels,(function(t){t.disconnect()}))},t}();var wt={createChannels:function(){return new kt},createConnectionManager:function(t,n){return new St(t,n)},createChannel:function(t,n){return new dt(t,n)},createPrivateChannel:function(t,n){return new bt(t,n)},createPresenceChannel:function(t,n){return new mt(t,n)},createTimelineSender:function(t,n){return new it(t,n)},createAuthorizer:function(t,n){return n.authorizer?n.authorizer(t,n):new ot(t,n)},createHandshake:function(t,n){return new et(t,n)},createAssistantToTheTransportManager:function(t,n,e){return new $(t,n,e)}},Tt=function(){function t(t){this.options=t||{},this.livesLeft=this.options.lives||1/0}return t.prototype.getAssistant=function(t){return wt.createAssistantToTheTransportManager(this,t,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},t.prototype.isAlive=function(){return this.livesLeft>0},t.prototype.reportDeath=function(){this.livesLeft-=1},t}(),Ct=function(){function t(t,n){this.strategies=t,this.loop=Boolean(n.loop),this.failFast=Boolean(n.failFast),this.timeout=n.timeout,this.timeoutLimit=n.timeoutLimit}return t.prototype.isSupported=function(){return A(this.strategies,m.method("isSupported"))},t.prototype.connect=function(t,n){var e=this,o=this.strategies,i=0,r=this.timeout,s=null,c=function(a,u){u?n(null,u):(i+=1,e.loop&&(i%=o.length),i<o.length?(r&&(r*=2,e.timeoutLimit&&(r=Math.min(r,e.timeoutLimit))),s=e.tryStrategy(o[i],t,{timeout:r,failFast:e.failFast},c)):n(!0))};return s=this.tryStrategy(o[i],t,{timeout:r,failFast:this.failFast},c),{abort:function(){s.abort()},forceMinPriority:function(n){t=n,s&&s.forceMinPriority(n)}}},t.prototype.tryStrategy=function(t,n,e,o){var i=null,r=null;return e.timeout>0&&(i=new g(e.timeout,(function(){r.abort(),o(!0)}))),r=t.connect(n,(function(t,n){t&&i&&i.isRunning()&&!e.failFast||(i&&i.ensureAborted(),o(t,n))})),{abort:function(){i&&i.ensureAborted(),r.abort()},forceMinPriority:function(t){r.forceMinPriority(t)}}},t}(),Ot=function(){function t(t){this.strategies=t}return t.prototype.isSupported=function(){return A(this.strategies,m.method("isSupported"))},t.prototype.connect=function(t,n){return function(t,n,e){var o=O(t,(function(t,o,i,r){return t.connect(n,e(o,r))}));return{abort:function(){C(o,Pt)},forceMinPriority:function(t){C(o,(function(n){n.forceMinPriority(t)}))}}}(this.strategies,t,(function(t,e){return function(o,i){e[t].error=o,o?function(t){return function(t,n){for(var e=0;e<t.length;e++)if(!n(t[e],e,t))return!1;return!0}(t,(function(t){return Boolean(t.error)}))}(e)&&n(!0):(C(e,(function(t){t.forceMinPriority(i.transport.priority)})),n(null,i))}}))},t}();function Pt(t){t.error||t.aborted||(t.abort(),t.aborted=!0)}var Lt=function(){function t(t,n,e){this.strategy=t,this.transports=n,this.ttl=e.ttl||18e5,this.usingTLS=e.useTLS,this.timeline=e.timeline}return t.prototype.isSupported=function(){return this.strategy.isSupported()},t.prototype.connect=function(t,n){var e=this.usingTLS,o=function(t){var n=Kt.getLocalStorage();if(n)try{var e=n[At(t)];if(e)return JSON.parse(e)}catch(n){Et(t)}return null}(e),i=[this.strategy];if(o&&o.timestamp+this.ttl>=m.now()){var r=this.transports[o.transport];r&&(this.timeline.info({cached:!0,transport:o.transport,latency:o.latency}),i.push(new Ct([r],{timeout:2*o.latency+1e3,failFast:!0})))}var s=m.now(),c=i.pop().connect(t,(function o(r,a){r?(Et(e),i.length>0?(s=m.now(),c=i.pop().connect(t,o)):n(r)):(!function(t,n,e){var o=Kt.getLocalStorage();if(o)try{o[At(t)]=j({timestamp:m.now(),transport:n,latency:e})}catch(t){}}(e,a.transport.name,m.now()-s),n(null,a))}));return{abort:function(){c.abort()},forceMinPriority:function(n){t=n,c&&c.forceMinPriority(n)}}},t}();function At(t){return"pusherTransport"+(t?"TLS":"NonTLS")}function Et(t){var n=Kt.getLocalStorage();if(n)try{delete n[At(t)]}catch(t){}}var Rt=function(){function t(t,n){var e=n.delay;this.strategy=t,this.options={delay:e}}return t.prototype.isSupported=function(){return this.strategy.isSupported()},t.prototype.connect=function(t,n){var e,o=this.strategy,i=new g(this.options.delay,(function(){e=o.connect(t,n)}));return{abort:function(){i.ensureAborted(),e&&e.abort()},forceMinPriority:function(n){t=n,e&&e.forceMinPriority(n)}}},t}(),jt=function(){function t(t,n,e){this.test=t,this.trueBranch=n,this.falseBranch=e}return t.prototype.isSupported=function(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()},t.prototype.connect=function(t,n){return(this.test()?this.trueBranch:this.falseBranch).connect(t,n)},t}(),xt=function(){function t(t){this.strategy=t}return t.prototype.isSupported=function(){return this.strategy.isSupported()},t.prototype.connect=function(t,n){var e=this.strategy.connect(t,(function(t,o){o&&e.abort(),n(t,o)}));return e},t}();function It(t){return function(){return t.isSupported()}}var Mt,Dt=function(t,n){var e={};function o(o,i,r,s,c){var a=n(t,o,i,r,s,c);return e[o]=a,a}var i,r={hostNonTLS:t.wsHost+":"+t.wsPort,hostTLS:t.wsHost+":"+t.wssPort,httpPath:t.wsPath},s=_({},r,{useTLS:!0}),c={hostNonTLS:t.httpHost+":"+t.httpPort,hostTLS:t.httpHost+":"+t.httpsPort,httpPath:t.httpPath},a={loop:!0,timeout:15e3,timeoutLimit:6e4},u=new Tt({lives:2,minPingDelay:1e4,maxPingDelay:t.activity_timeout}),h=new Tt({lives:2,minPingDelay:1e4,maxPingDelay:t.activity_timeout}),p=o("ws","ws",3,r,u),l=o("wss","ws",3,s,u),f=o("xhr_streaming","xhr_streaming",1,c,h),d=o("xhr_polling","xhr_polling",1,c),y=new Ct([p],a),b=new Ct([l],a),g=new Ct([f],a),v=new Ct([d],a),m=new Ct([new jt(It(g),new Ot([g,new Rt(v,{delay:4e3})]),v)],a);return i=t.useTLS?new Ot([y,new Rt(m,{delay:2e3})]):new Ot([y,new Rt(b,{delay:2e3}),new Rt(m,{delay:5e3})]),new Lt(new xt(new jt(It(p),i,m)),e,{ttl:18e5,timeline:t.timeline,useTLS:t.useTLS})},Nt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Ht=function(t){function n(n,e,o){var i=t.call(this)||this;return i.hooks=n,i.method=e,i.url=o,i}return Nt(n,t),n.prototype.start=function(t){var n=this;this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=function(){n.close()},Kt.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(t)},n.prototype.close=function(){this.unloader&&(Kt.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)},n.prototype.onChunk=function(t,n){for(;;){var e=this.advanceBuffer(n);if(!e)break;this.emit("chunk",{status:t,data:e})}this.isBufferTooLong(n)&&this.emit("buffer_too_long")},n.prototype.advanceBuffer=function(t){var n=t.slice(this.position),e=n.indexOf("\n");return-1!==e?(this.position+=e+1,n.slice(0,e)):null},n.prototype.isBufferTooLong=function(t){return this.position===t.length&&t.length>262144},n}(z);!function(t){t[t.CONNECTING=0]="CONNECTING",t[t.OPEN=1]="OPEN",t[t.CLOSED=3]="CLOSED"}(Mt||(Mt={}));var Ut=Mt,zt=1;function qt(t){var n=-1===t.indexOf("?")?"?":"&";return t+n+"t="+ +new Date+"&n="+zt++}function Ft(t){return Math.floor(Math.random()*t)}var Bt,Jt=function(){function t(t,n){this.hooks=t,this.session=Ft(1e3)+"/"+function(t){for(var n=[],e=0;e<t;e++)n.push(Ft(32).toString(32));return n.join("")}(8),this.location=function(t){var n=/([^\?]*)\/*(\??.*)/.exec(t);return{base:n[1],queryString:n[2]}}(n),this.readyState=Ut.CONNECTING,this.openStream()}return t.prototype.send=function(t){return this.sendRaw(JSON.stringify([t]))},t.prototype.ping=function(){this.hooks.sendHeartbeat(this)},t.prototype.close=function(t,n){this.onClose(t,n,!0)},t.prototype.sendRaw=function(t){if(this.readyState!==Ut.OPEN)return!1;try{return Kt.createSocketRequest("POST",qt((n=this.location,e=this.session,n.base+"/"+e+"/xhr_send"))).start(t),!0}catch(t){return!1}var n,e},t.prototype.reconnect=function(){this.closeStream(),this.openStream()},t.prototype.onClose=function(t,n,e){this.closeStream(),this.readyState=Ut.CLOSED,this.onclose&&this.onclose({code:t,reason:n,wasClean:e})},t.prototype.onChunk=function(t){var n;if(200===t.status)switch(this.readyState===Ut.OPEN&&this.onActivity(),t.data.slice(0,1)){case"o":n=JSON.parse(t.data.slice(1)||"{}"),this.onOpen(n);break;case"a":n=JSON.parse(t.data.slice(1)||"[]");for(var e=0;e<n.length;e++)this.onEvent(n[e]);break;case"m":n=JSON.parse(t.data.slice(1)||"null"),this.onEvent(n);break;case"h":this.hooks.onHeartbeat(this);break;case"c":n=JSON.parse(t.data.slice(1)||"[]"),this.onClose(n[0],n[1],!0)}},t.prototype.onOpen=function(t){var n,e,o;this.readyState===Ut.CONNECTING?(t&&t.hostname&&(this.location.base=(n=this.location.base,e=t.hostname,(o=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(n))[1]+e+o[3])),this.readyState=Ut.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)},t.prototype.onEvent=function(t){this.readyState===Ut.OPEN&&this.onmessage&&this.onmessage({data:t})},t.prototype.onActivity=function(){this.onactivity&&this.onactivity()},t.prototype.onError=function(t){this.onerror&&this.onerror(t)},t.prototype.openStream=function(){var t=this;this.stream=Kt.createSocketRequest("POST",qt(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",(function(n){t.onChunk(n)})),this.stream.bind("finished",(function(n){t.hooks.onFinished(t,n)})),this.stream.bind("buffer_too_long",(function(){t.reconnect()}));try{this.stream.start()}catch(n){m.defer((function(){t.onError(n),t.onClose(1006,"Could not start streaming",!1)}))}},t.prototype.closeStream=function(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)},t}(),Xt={getReceiveURL:function(t,n){return t.base+"/"+n+"/xhr_streaming"+t.queryString},onHeartbeat:function(t){t.sendRaw("[]")},sendHeartbeat:function(t){t.sendRaw("[]")},onFinished:function(t,n){t.onClose(1006,"Connection interrupted ("+n+")",!1)}},Wt={getReceiveURL:function(t,n){return t.base+"/"+n+"/xhr"+t.queryString},onHeartbeat:function(){},sendHeartbeat:function(t){t.sendRaw("[]")},onFinished:function(t,n){200===n?t.reconnect():t.onClose(1006,"Connection interrupted ("+n+")",!1)}},Gt={getRequest:function(t){var n=new(Kt.getXHRAPI());return n.onreadystatechange=n.onprogress=function(){switch(n.readyState){case 3:n.responseText&&n.responseText.length>0&&t.onChunk(n.status,n.responseText);break;case 4:n.responseText&&n.responseText.length>0&&t.onChunk(n.status,n.responseText),t.emit("finished",n.status),t.close()}},n},abortRequest:function(t){t.onreadystatechange=null,t.abort()}},Qt={getDefaultStrategy:Dt,Transports:Y,transportConnectionInitializer:function(){this.timeline.info(this.buildTimelineMessage({transport:this.name+(this.options.useTLS?"s":"")})),this.hooks.isInitialized()?this.changeState("initialized"):this.onClose()},HTTPFactory:{createStreamingSocket:function(t){return this.createSocket(Xt,t)},createPollingSocket:function(t){return this.createSocket(Wt,t)},createSocket:function(t,n){return new Jt(t,n)},createXHR:function(t,n){return this.createRequest(Gt,t,n)},createRequest:function(t,n,e){return new Ht(t,n,e)}},setup:function(t){t.ready()},getLocalStorage:function(){},getClientFeatures:function(){return T(L({ws:Y.ws},(function(t){return t.isSupported({})})))},getProtocol:function(){return"http:"},isXHRSupported:function(){return!0},createSocketRequest:function(t,n){if(this.isXHRSupported())return this.HTTPFactory.createXHR(t,n);throw"Cross-origin HTTP requests are not supported"},createXHR:function(){return new(this.getXHRAPI())},createWebSocket:function(t){return new(this.getWebSocketAPI())(t)},addUnloadListener:function(t){},removeUnloadListener:function(t){}},Vt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Yt=new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return Vt(n,t),n.prototype.isOnline=function(){return!0},n}(z)),$t=function(t,n,e){var o=new Headers;for(var i in o.set("Content-Type","application/x-www-form-urlencoded"),this.authOptions.headers)o.set(i,this.authOptions.headers[i]);var r=this.composeQuery(n),s=new Request(this.options.authEndpoint,{headers:o,body:r,credentials:"same-origin",method:"POST"});return fetch(s).then((function(t){var n=t.status;if(200===n)return t.text();throw q.warn("Couldn't get auth info from your webapp",n),n})).then((function(t){try{t=JSON.parse(t)}catch(e){var n="JSON returned from webapp was invalid, yet status code was 200. Data was: "+t;throw q.warn(n),n}e(!1,t)})).catch((function(t){e(!0,t)}))},Kt={getDefaultStrategy:Qt.getDefaultStrategy,Transports:Qt.Transports,setup:Qt.setup,getProtocol:Qt.getProtocol,isXHRSupported:Qt.isXHRSupported,getLocalStorage:Qt.getLocalStorage,createXHR:Qt.createXHR,createWebSocket:Qt.createWebSocket,addUnloadListener:Qt.addUnloadListener,removeUnloadListener:Qt.removeUnloadListener,transportConnectionInitializer:Qt.transportConnectionInitializer,createSocketRequest:Qt.createSocketRequest,HTTPFactory:Qt.HTTPFactory,TimelineTransport:{name:"xhr",getAgent:function(t,n){return function(e,o){var i="http"+(n?"s":"")+"://"+(t.host||t.options.host)+t.options.path,r=R(e);fetch(i+="/2?"+r).then((function(t){if(200!==t.status)throw"received "+t.status+" from stats.pusher.com";return t.json()})).then((function(n){var e=n.host;e&&(t.host=e)})).catch((function(t){q.debug("TimelineSender Error: ",t)}))}}},getAuthorizers:function(){return{ajax:$t}},getWebSocketAPI:function(){return WebSocket},getXHRAPI:function(){return XMLHttpRequest},getNetwork:function(){return Yt}};!function(t){t[t.ERROR=3]="ERROR",t[t.INFO=6]="INFO",t[t.DEBUG=7]="DEBUG"}(Bt||(Bt={}));var Zt=Bt,tn=function(){function t(t,n,e){this.key=t,this.session=n,this.events=[],this.options=e||{},this.sent=0,this.uniqueID=0}return t.prototype.log=function(t,n){t<=this.options.level&&(this.events.push(_({},n,{timestamp:m.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},t.prototype.error=function(t){this.log(Zt.ERROR,t)},t.prototype.info=function(t){this.log(Zt.INFO,t)},t.prototype.debug=function(t){this.log(Zt.DEBUG,t)},t.prototype.isEmpty=function(){return 0===this.events.length},t.prototype.send=function(t,n){var e=this,o=_({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],t(o,(function(t,o){t||e.sent++,n&&n(t,o)})),!0},t.prototype.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},t}(),nn=function(){function t(t,n,e,o){this.name=t,this.priority=n,this.transport=e,this.options=o||{}}return t.prototype.isSupported=function(){return this.transport.isSupported({useTLS:this.options.useTLS})},t.prototype.connect=function(t,n){var e=this;if(!this.isSupported())return en(new ht,n);if(this.priority<t)return en(new ct,n);var o=!1,i=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),r=null,s=function(){i.unbind("initialized",s),i.connect()},c=function(){r=wt.createHandshake(i,(function(t){o=!0,h(),n(null,t)}))},a=function(t){h(),n(t)},u=function(){var t;h(),t=j(i),n(new at(t))},h=function(){i.unbind("initialized",s),i.unbind("open",c),i.unbind("error",a),i.unbind("closed",u)};return i.bind("initialized",s),i.bind("open",c),i.bind("error",a),i.bind("closed",u),i.initialize(),{abort:function(){o||(h(),r?r.close():i.close())},forceMinPriority:function(t){o||e.priority<t&&(r?r.close():i.close())}}},t}();function en(t,n){return m.defer((function(){n(t)})),{abort:function(){},forceMinPriority:function(){}}}var on=Kt.Transports,rn=function(t,n,e,o,i,r){var s=on[e];if(!s)throw new ut(e);return!(t.enabledTransports&&-1===k(t.enabledTransports,n)||t.disabledTransports&&-1!==k(t.disabledTransports,n))?new nn(n,o,r?r.getAssistant(s):s,_({key:t.key,useTLS:t.useTLS,timeline:t.timeline,ignoreNullOrigin:t.ignoreNullOrigin},i)):sn},sn={isSupported:function(){return!1},connect:function(t,n){var e=m.defer((function(){n(new ht)}));return{abort:function(){e.ensureAborted()},forceMinPriority:function(){}}}},cn=function(){return{wsHost:x.host,wsPort:x.ws_port,wssPort:x.wss_port,wsPath:x.ws_path,httpHost:x.sockjs_host,httpPort:x.sockjs_http_port,httpsPort:x.sockjs_https_port,httpPath:x.sockjs_path,statsHost:x.stats_host,authEndpoint:x.channel_auth_endpoint,authTransport:x.channel_auth_transport,activity_timeout:x.activity_timeout,pong_timeout:x.pong_timeout,unavailable_timeout:x.unavailable_timeout}},an=function(t){return{wsHost:"ws-"+t+".pusher.com",httpHost:"sockjs-"+t+".pusher.com"}},un=function(){function t(n,e){var o=this;if(function(t){if(null==t)throw"You must pass your app key when you instantiate Pusher."}(n),!(e=e||{}).cluster&&!e.wsHost&&!e.httpHost){var i=lt.buildLogSuffix("javascriptQuickStart");q.warn("You should always specify a cluster when connecting. "+i)}this.key=n,this.config=_(cn(),e.cluster?an(e.cluster):{},e),this.channels=wt.createChannels(),this.global_emitter=new z,this.sessionID=Math.floor(1e9*Math.random()),this.timeline=new tn(this.key,this.sessionID,{cluster:this.config.cluster,features:t.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:Zt.INFO,version:x.VERSION}),this.config.disableStats||(this.timelineSender=wt.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+Kt.TimelineTransport.name}));this.connection=wt.createConnectionManager(this.key,_({getStrategy:function(t){var n=_({},o.config,t);return Kt.getDefaultStrategy(n,rn)},timeline:this.timeline,activityTimeout:this.config.activity_timeout,pongTimeout:this.config.pong_timeout,unavailableTimeout:this.config.unavailable_timeout},this.config,{useTLS:this.shouldUseTLS()})),this.connection.bind("connected",(function(){o.subscribeAll(),o.timelineSender&&o.timelineSender.send(o.connection.isUsingTLS())})),this.connection.bind("message",(function(t){var n=0===t.event.indexOf("pusher_internal:");if(t.channel){var e=o.channel(t.channel);e&&e.handleEvent(t)}n||o.global_emitter.emit(t.event,t.data)})),this.connection.bind("connecting",(function(){o.channels.disconnect()})),this.connection.bind("disconnected",(function(){o.channels.disconnect()})),this.connection.bind("error",(function(t){q.warn("Error",t)})),t.instances.push(this),this.timeline.info({instances:t.instances.length}),t.isReady&&this.connect()}return t.ready=function(){t.isReady=!0;for(var n=0,e=t.instances.length;n<e;n++)t.instances[n].connect()},t.log=function(n){t.logToConsole&&self.console&&self.console.log&&self.console.log(n)},t.getClientFeatures=function(){return T(L({ws:Kt.Transports.ws},(function(t){return t.isSupported({})})))},t.prototype.channel=function(t){return this.channels.find(t)},t.prototype.allChannels=function(){return this.channels.all()},t.prototype.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var t=this.connection.isUsingTLS(),n=this.timelineSender;this.timelineSenderTimer=new v(6e4,(function(){n.send(t)}))}},t.prototype.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},t.prototype.bind=function(t,n,e){return this.global_emitter.bind(t,n,e),this},t.prototype.unbind=function(t,n,e){return this.global_emitter.unbind(t,n,e),this},t.prototype.bind_global=function(t){return this.global_emitter.bind_global(t),this},t.prototype.unbind_global=function(t){return this.global_emitter.unbind_global(t),this},t.prototype.unbind_all=function(t){return this.global_emitter.unbind_all(),this},t.prototype.subscribeAll=function(){var t;for(t in this.channels.channels)this.channels.channels.hasOwnProperty(t)&&this.subscribe(t)},t.prototype.subscribe=function(t){var n=this.channels.add(t,this);return n.subscriptionPending&&n.subscriptionCancelled?n.reinstateSubscription():n.subscriptionPending||"connected"!==this.connection.state||n.subscribe(),n},t.prototype.unsubscribe=function(t){var n=this.channels.find(t);n&&n.subscriptionPending?n.cancelSubscription():(n=this.channels.remove(t))&&"connected"===this.connection.state&&n.unsubscribe()},t.prototype.send_event=function(t,n,e){return this.connection.send_event(t,n,e)},t.prototype.shouldUseTLS=function(){return"https:"===Kt.getProtocol()||(!0===this.config.forceTLS||Boolean(this.config.encrypted))},t.instances=[],t.isReady=!1,t.logToConsole=!1,t.Runtime=Kt,t.ScriptReceivers=Kt.ScriptReceivers,t.DependenciesReceivers=Kt.DependenciesReceivers,t.auth_callbacks=Kt.auth_callbacks,t}(),hn=n.default=un;Kt.setup(un)}]);